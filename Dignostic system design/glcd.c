#include <reg51.h>

/**LCD PIN DEFINITION**/
#define glcd P0
#include"delay.h"
// IN-BUILT FOR T.B

sbit RS=P3^4; 
sbit RW=P3^5;
sbit EN=P3^6;

sbit RST=P1^2;
sbit CS2=P1^3;
sbit CS1=P1^4;


code unsigned char arr[95][6] =
{  
   {0x00,0x00,0x00,0x00,0x00,0},   	//  space 
   {0x00,0x00,0x4F,0x00,0x00,0},      	//  '!'
   {0x00,0x07,0x00,0x07,0x00,0},      	//  '"'
   {0x14,0x7F,0x14,0x7F,0x14,0},  	//  '#'
   {0x24,0x2A,0x7F,0x2A,0x12,0},  	//  '$'
   {0x23,0x13,0x08,0x64,0x62,0},   	//  '%'
   {0x00,0x02,0x05,0x02,0x00,0},  	//  '&'
   {0x00,0x05,0x03,0x00,0x00,0},       	//  '''
   {0x1C,0x22,0x41,0x00,0x00,0},    	//  '('
   {0x00,0x00,0x41,0x22,0x1C,0},    	//  ')'
   {0x14,0x08,0x3E,0x08,0x14,0},    	//  '*'
   {0x08,0x08,0x3E,0x08,0x08,0},      	//  '+'
   {0x00,0x50,0x30,0x00,0x00,0},     	//  ','
   {0x08,0x08,0x08,0x08,0x08,0},       	//  '-' 
   {0x00,0x60,0x60,0x00,0x00,0},     	//  '.'
   {0x20,0x10,0x08,0x04,0x02,0},     	//  '/'
   {0x3E,0x51,0x49,0x45,0x3E,0},  		//  '0'
   {0x00,0x42,0x7F,0x40,0x00,0},    	//  '1'
   {0x42,0x61,0x51,0x49,0x46,0},   	//  '2'
   {0x21,0x41,0x45,0x4B,0x31,0},   	//  '3'
   {0x18,0x14,0x12,0x7F,0x10,0},   	//  '4'
   {0x27,0x45,0x45,0x45,0x39,0} ,  	//  '5'
   {0x3C,0x4A,0x49,0x49,0x30,0},   	//  '6'
   {0x01,0x71,0x09,0x05,0x03,0},       	//  '7'
   {0x36,0x49,0x49,0x49,0x36,0},   	//  '8'
   {0x06,0x49,0x49,0x49,0x36,0},   	//  '9' 
   {0x00,0x36,0x36,0x00,0x00,0},      	//  ':'
   {0x00,0x56,0x36,0x00,0x00,0},   	//  ';'
   {0x08,0x14,0x22,0x41,0x00,0},     	//  '<'
   {0x14,0x14,0x14,0x14,0x14,0},   	//  '='
   {0x00,0x41,0x22,0x14,0x08,0},     	//  '>'
   {0x02,0x01,0x51,0x09,0x06,0},       	//  '?'
   {0x32,0x49,0x79,0x41,0x3E,0},   	//  '@'
   {0x7E,0x11,0x11,0x11,0x7E,0},  	//  'A'
   {0x7F,0x49,0x49,0x49,0x36,0},    	//  'B'
   {0x3E,0x41,0x41,0x41,0x22,0},   	//  'C'
   {0x7F,0x41,0x41,0x22,0x1C,0},   	//  'D'
   {0x7F,0x49,0x49,0x49,0x41,0},   	//  'E'
   {0x7F,0x09,0x09,0x09,0x01,0},       	//  'F'  
   {0x3E,0x41,0x49,0x49,0x7A,0},   	//  'G'
   {0x7F,0x08,0x08,0x08,0x7F,0},      	//  'H'
   {0x00,0x41,0x7F,0x41,0x00,0},     	//  'I'
   {0x20,0x40,0x41,0x3F,0x01,0},    	//  'J'
   {0x7F,0x08,0x14,0x22,0x41,0},    	//  'K'
   {0x7F,0x40,0x40,0x40,0x40,0},   	//  'L'
   {0x7F,0x02,0x0C,0x02,0x7F,0},       	//  'M'
   {0x7F,0x04,0x08,0x10,0x7F,0},    	//  'N'
   {0x3E,0x41,0x41,0x41,0x3E,0},    	//  'O'
   {0x7F,0x09,0x09,0x09,0x06,0},    	//  'P'
   {0x3E,0x41,0x51,0x21,0x5E,0},   	//  'Q'
   {0x7F,0x09,0x19,0x29,0x46,0},    	//  'R' 
   {0x46,0x49,0x49,0x49,0x31,0},     	//  'S'
   {0x01,0x01,0x7F,0x01,0x01,0},        //  'T'
   {0x3F,0x40,0x40,0x40,0x3F,0},    	//  'U'
   {0x1F,0x20,0x40,0x20,0x1F,0},     	//  'V'
   {0x3F,0x40,0x38,0x40,0x3F,0},     	//  'W'
   {0x63,0x14,0x08,0x14,0x63,0},     	//  'X'
   {0x07,0x08,0x70,0x08,0x07,0},        //  'Y'
   {0x61,0x51,0x49,0x45,0x43,0},    	//  'Z'  
   {0x7F,0x41,0x41,0x00,0x00,0},    	//  '['
   {0x02,0x04,0x08,0x01,0x02,0},      	//  '\'
   {0x00,0x00,0x41,0x41,0x7F,0},   		//  ']'
   {0x04,0x02,0x01,0x02,0x04,0},        //  '^'
   {0x40,0x40,0x40,0x40,0x40,0},    	//  '_'
   {0x00,0x01,0x02,0x04,0x00,0},        //  '`'
   {0x20,0x54,0x54,0x54,0x78,0},    	//  'a'   
   {0x7F,0x48,0x44,0x44,0x38,0},    	//  'b'
   {0x38,0x44,0x44,0x44,0x20,0},    	//  'c'
   {0x38,0x44,0x44,0x48,0x7F,0},   		//  'd'
   {0x38,0x54,0x54,0x54,0x18,0},    	//  'e'
   {0x08,0x7E,0x09,0x01,0x02,0},        //  'f'
   {0x0C,0x52,0x52,0x52,0x3E,0},      	//  'g'
   {0x7F,0x08,0x04,0x04,0x78,0},        //  'h'
   {0x00,0x44,0x7D,0x40,0x00,0},       	//  'i'
   {0x00,0x20,0x40,0x44,0x3D,0},      	//  'j'
   {0x7F,0x10,0x28,0x44,0x00,0},      	//  'k'
   {0x00,0x41,0x7F,0x40,0x00,0},       	//  'l'
   {0x7C,0x04,0x18,0x04,0x78,0},       	//  'm'
   {0x7C,0x08,0x04,0x04,0x78,0},        //  'n'
   {0x38,0x44,0x44,0x44,0x38,0},     	//  'o'
   {0x7C,0x14,0x14,0x14,0x08,0},      	//  'p'
   {0x08,0x14,0x14,0x18,0x7C,0},      	//  'q'
   {0x7C,0x08,0x04,0x04,0x08,0},        //  'r'
   {0x48,0x54,0x54,0x54,0x20,0},     	//  's'
   {0x04,0x3F,0x44,0x40,0x20,0},      	//  't'
   {0x3C,0x40,0x40,0x20,0x7C,0},     	//  'u'
   {0x1C,0x20,0x40,0x20,0x1C,0},     	//  'v'
   {0x3C,0x40,0x30,0x40,0x3C,0},     	//  'w'
   {0x44,0x28,0x10,0x28,0x44,0},     	//  'x'
   {0x0C,0x50,0x50,0x50,0x3C,0},      	//  'y'
   {0x44,0x64,0x54,0x4C,0x44,0},      	//  'z'
   {0x08,0x36,0x41,0x00,0x00,0},        //  '{'
   {0x00,0x00,0x7F,0x00,0x00,0},        //  '|'
   {0x00,0x00,0x41,0x36,0x08,0},        //  '}'
   {0x00,0x08,0x04,0x08,0x04,0}         //  '~'
};


void delay(unsigned int t)
{
	unsigned int x,y;
	for(x=0;x<1275;x++)
		for(y=0;y<t;y++);	
}


void write_cmd(unsigned char cmd)
{
	RS = 0; 
    CS1 = 1;
    CS2 = 1;                             
    glcd =  cmd;
    EN = 1;                
    EN = 0;   
    delay(2);        
}


void write_dat(unsigned char dat)
{
	RS = 1;	
    glcd = dat;
    EN = 1;
	EN = 0;
delay(2);        

}


void glcd_char(unsigned char page, unsigned char hposi, unsigned char ch)
{
	unsigned char i,j;
	write_cmd(hposi);
	write_cmd(page);
	CS1=1;
	CS2=0;
	j=ch-32;
	for(i=0;i<6;i++)
	{
		write_dat(arr[j][i]);
	}
}

void glcd_str(unsigned char page, unsigned char hposi, unsigned char *ch)
{
	unsigned char i,j,k;
	while(*ch!='\0')
	{
		write_cmd(hposi);
		write_cmd(page);
		CS1=1;
		CS2=0;
		for(k=0;k<10;k++)
		{
			if(*ch=='\0')
				break;
			j=*ch-32;
			ch++;
			for(i=0;i<6;i++)
			{
				write_dat(arr[j][i]);
			}
		}
	}
}




void glcd_init(void)
{   
    /*******RESET***********/
	RST = 0;
    delay(10);
    RST = 1;
    delay(1);
	/**********************/
    EN = 0;
    CS1 = 0;
    CS2 = 0;
    RW = 0;
    RS = 0;
    write_cmd(0x3e);	      // 0x3E turn it Off.
    write_cmd(0x3f);	     // 0x3F Display ON.
    write_cmd(0x40);         // display data in horizontal way(0-63) 
    write_cmd(0xb8);        // display data in vertical way(0-7)
    write_cmd(0xc0); 	   // indicates the display data RAM displayed on the top of the screen              
}


void glcd_clr(unsigned char val)
{
     int i,y;
     CS1 = 1;
     CS2 = 1;	
     for(i=0xb8;i<0xc0;i++)
     {
            write_cmd(i);                        // Select Pages.  
	        write_cmd(0x40);                      
            for (y=0;y<64;y++)
   	   	 		write_dat(val);                  // Clear data in the LCD.
	 }
}
